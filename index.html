<!DOCTYPE html>
<html lang="cs">
<head>
    <link rel="manifest" href="manifest.json">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#6366f1">
    <title>Moje Knihovna</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="loginScreen">
        <div class="login-box">
            <h1>Knihovna Login</h1>
            <div id="loginError" class="error-msg">≈†patn√© jm√©no nebo heslo.</div>
            <input type="text" id="usernameInput" placeholder="U≈æivatelsk√© jm√©no">
            <input type="password" id="passwordInput" placeholder="Heslo">
            <button onclick="login()">P≈ôihl√°sit se</button>
            <button class="btn-secondary" onclick="register()">Vytvo≈ôit nov√Ω √∫ƒçet</button>
        </div>
    </div>

    <div id="appScreen">
        <div id="sidebarOverlay" class="sidebar-overlay" onclick="toggleSidebar()"></div>

        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>Knihovna</h2>
                <button class="close-menu-btn" onclick="toggleSidebar()">‚úï</button>
            </div>
            
            <ul id="menuList">
                <li class="active" onclick="setActiveMenu(this); renderHome()">Hlavn√≠ str√°nka</li>
                <li onclick="setActiveMenu(this); renderSeriesView()">Kni≈æn√≠ s√©rie</li>
                <hr style="margin: 15px 0; border: 0; border-top: 1px solid #e2e8f0;">
                <li onclick="setActiveMenu(this); filterByPurpose('Pro radost')">Knihy pro radost</li>
                <li onclick="setActiveMenu(this); filterByPurpose('Povinn√° ƒçetba')">Povinn√° ƒçetba</li>
                <hr style="margin: 15px 0; border: 0; border-top: 1px solid #e2e8f0;">
                <li onclick="setActiveMenu(this); filterByOwnership('Vlastn√≠')">Moje knihy</li>
                <li onclick="setActiveMenu(this); filterByReadingStatus('Doƒçteno')">P≈ôeƒçten√©</li>
                <li onclick="setActiveMenu(this); filterWishlist()">Wishlist</li>
            </ul>
            
            <div class="sidebar-bottom">
                <div class="add-btn" onclick="openModal()">+ P≈ôidat knihu</div>
                <div class="user-info">P≈ôihl√°≈°en: <strong id="loggedUserName"></strong></div>
                <div class="logout-btn" onclick="logout()">Odhl√°sit se</div>
            </div>
        </aside>

        <main class="main-content">
            <div class="header-top">
                <div class="header-title-row">
                    <button class="menu-btn" onclick="toggleSidebar()">‚ò∞</button>
                    <h1 id="pageTitle">V≈°echny knihy</h1>
                </div>
                
                <div class="search-filter-wrapper">
                    <input type="text" id="searchInput" class="search-bar" placeholder="Hledat podle n√°zvu nebo autora..." onkeyup="searchBooks()">
                    <button class="toggle-filters-btn" onclick="toggleFilters()">Filtry ‚öôÔ∏è</button>
                </div>
            </div>

            <div id="filtersPanel" class="filters-panel hidden">
                <div class="filters-grid">
                    <div class="filter-group">
                        <label>Form√°t</label>
                        <select onchange="filterByFormat(this.value)">
                            <option value="">V≈°echny form√°ty</option>
                            <option value="Fyzick√°">Fyzick√° kniha</option>
                            <option value="E-book">E-book</option>
                            <option value="Oboj√≠">Fyzick√° i E-book</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Stav ƒçten√≠</label>
                        <select onchange="filterByReadingStatus(this.value)">
                            <option value="">V≈°echny stavy</option>
                            <option value="Ve ƒçten√≠">Rozeƒçteno</option>
                            <option value="Doƒçteno">P≈ôeƒçteno</option>
                            <option value="Nep≈ôeƒçteno">Nep≈ôeƒçteno</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Jazyk</label>
                        <select id="filterLanguage" onchange="filterByLanguage(this.value)">
                            <option value="">V≈°echny jazyky</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>≈Ω√°nry</label>
                        <select id="filterGenre" onchange="filterByGenre(this.value)">
                            <option value="">V≈°echny ≈æ√°nry</option>
                        </select>
                    </div>
                </div>
            </div>

            <div id="backToBooksBtn" style="display: none; margin-bottom: 20px;">
                <button onclick="renderHome()" style="padding: 10px 15px; background: var(--surface); border: 2px solid var(--primary); border-radius: 10px; cursor: pointer; font-weight: bold; color: var(--primary);">‚Üê Zpƒõt na seznam</button>
            </div>

            <div class="books-grid" id="booksGrid"></div>
        </main>
    </div>

    <div class="modal-overlay" id="bookModal">
        <div class="modal">
            <h2 id="modalTitle">Nov√° kniha</h2>
            <form id="bookForm" onsubmit="saveBook(event)">
                <input type="hidden" id="bookId">
                <div class="form-group">
                    <label>N√°zev knihy</label>
                    <input type="text" id="bTitle" required>
                </div>
                <div class="form-group">
                    <label>Autor</label>
                    <input type="text" id="bAuthor" list="authorDatalist" required>
                    <datalist id="authorDatalist"></datalist>
                </div>
                
                <div class="form-row">
                    <div class="form-group" style="flex: 1;">
                        <label>√öƒçel ƒçten√≠</label>
                        <select id="bPurpose">
                            <option value="Pro radost">Pro radost / z√°bavu</option>
                            <option value="Povinn√° ƒçetba">Povinn√° ƒçetba k maturitƒõ</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <label>Odkaz na rozbor (nap≈ô. Google Docs)</label>
                        <input type="url" id="bRozborUrl" placeholder="https://docs.google.com/...">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group" style="flex: 1;">
                        <label>Kni≈æn√≠ s√©rie (voliteln√©)</label>
                        <input type="text" id="bSeries" placeholder="Nap≈ô. Zakl√≠naƒç">
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <label>D√≠l v s√©rii</label>
                        <input type="number" id="bSeriesOrder" min="1" placeholder="Nap≈ô. 1">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Ob√°lka knihy</label>
                    <input type="url" id="bCoverUrl" placeholder="Vlo≈æit URL odkaz na obr√°zek" style="margin-bottom: 8px;">
                    <div style="text-align: center; font-size: 12px; color: #6b7280; margin-bottom: 8px;">NEBO</div>
                    <input type="file" id="bCoverFile" accept="image/*">
                    <input type="hidden" id="bCoverBase64">
                </div>

                <div class="form-group">
                    <label>Jazyk knihy</label>
                    <select id="bLanguage">
                        <option value="ƒåe≈°tina">ƒåe≈°tina</option>
                        <option value="Sloven≈°tina">Sloven≈°tina</option>
                        <option value="Angliƒçtina">Angliƒçtina</option>
                        <option value="Nƒõmƒçina">Nƒõmƒçina</option>
                        <option value="Jin√©">Jin√©</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>≈Ω√°nry (lze vybrat v√≠ce)</label>
                    <div class="checkbox-group" id="bGenresContainer"></div>
                </div>
                <div class="form-row">
                    <div class="form-group" style="flex: 1;">
                        <label>Form√°t</label>
                        <select id="bFormat">
                            <option value="Fyzick√°">Fyzick√° kniha</option>
                            <option value="E-book">E-book</option>
                            <option value="Oboj√≠">Oboj√≠ (Fyzick√° i E-book)</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <label>Stav ƒçten√≠</label>
                        <select id="bReadStatus">
                            <option value="Nep≈ôeƒçteno">Nep≈ôeƒçteno</option>
                            <option value="Ve ƒçten√≠">Rozeƒçteno</option>
                            <option value="Doƒçteno">Doƒçteno</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Vlastnictv√≠</label>
                    <select id="bOwnership">
                        <option value="Vlastn√≠">Vlastn√≠m</option>
                        <option value="P≈Øjƒçeno (ciz√≠)">M√°m p≈Øjƒçeno</option>
                        <option value="P≈Øjƒçeno (jin√Ωm)">P≈Øjƒçil jsem</option>
                        <option value="Wishlist">Wishlist</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Hodnocen√≠ (1-5)</label>
                    <input type="number" id="bRating" min="1" max="5">
                </div>

                <div class="form-group">
                    <label>Slovn√≠ hodnocen√≠ (Recenze)</label>
                    <textarea id="bReview" rows="3" placeholder="Co si o knize mysl√≠te?"></textarea>
                </div>
                
                <div class="form-group" id="deleteBtnContainer" style="display:none; text-align:right;">
                    <a href="#" style="color:#ef4444; font-size:13px; text-decoration:none;" onclick="deleteBook()">üóëÔ∏è Smazat tuto knihu</a>
                </div>

                <div class="btn-group">
                    <button type="button" class="btn-close" onclick="closeModal()">‚Üê Zpƒõt / Zru≈°it</button>
                    <button type="submit" class="btn-submit">Ulo≈æit knihu</button>
                </div>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
